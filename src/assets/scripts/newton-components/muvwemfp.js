/*! Built with http://stenciljs.com */
const{h:e}=window.NewtonComponents;class t{constructor(){this.showWhitResult=!1,this.avoidBind=["file","image"]}componentWillLoad(){this.isServer||("undefined"!=typeof newtonService?null!==newtonService.authUser.accessToken||void 0!==newtonService.authUser.accessToken?(this.showWhitResult&&this.setElementState(!1),this.getNewtonEvents()):console.error("Please login before use this component."):console.error("Newton Service not installed, please install @pfizer/newton-js-sdk and bind it to the window."))}getNewtonEvents(){const e=this.eventType?{eventType:this.eventType}:null;newtonService.service("event").get(e).then(e=>{this.result=e,this.completedHandler(),this.handleResponse()})}handleResponse(){this.showElement();for(const e of this.result)this.firstAttributeKey=Object.keys(e.attributes)[0],this.attribute=e.attributes,this.isItComplex()?this.handleComplexType():this.handleBindSimpleType()}showElement(){this.showWhitResult&&void 0!==this.result&&Object.keys(this.result).length>0&&this.setElementState(!0)}handleBindSimpleType(){[].forEach.call(this.element.querySelectorAll(`[data-property~="${this.firstAttributeKey}"]`),function(e){e.textContent=this.attribute[this.fisrtAttributeKey],e.value=this.attribute[this.fisrtAttributeKey]},this)}handleComplexType(){this.handleByType()?this.handleBindByType():this.handleBindComplexType()}handleBindByType(){const e=this.attribute[this.firstAttributeKey];[].forEach.call(this.element.querySelectorAll(`[data-property^="${this.firstAttributeKey}"]`),t=>{const s=t.dataset.property.split(".")[0];t.src=e.value[s]},this)}handleByType(){return this.attribute[this.firstAttributeKey].type&&this.avoidBind.indexOf(this.attribute[this.firstAttributeKey].type)>-1}handleBindComplexType(){[].forEach.call(this.element.querySelectorAll(`[data-property^="${this.firstAttributeKey}"]`),function(e){const t=this.getComplexElementValue(e);t&&(e.textContent=t,e.value=t)},this)}getComplexElementValue(e){try{let t=this.attribute;return e.dataset.property.split(".").forEach(e=>{t=t[e]}),t}catch(e){return null}}isItComplex(){return"object"==typeof this.attribute[this.firstAttributeKey]}completedHandler(){this.eventCompleted.emit(this.result)}setElementState(e){e?this.element.removeAttribute("hidden"):this.element.setAttribute("hidden","true")}render(){return[e("slot",{name:"display-component"})]}static get is(){return"newton-event-feed"}static get properties(){return{element:{elementRef:!0},eventType:{type:String,attr:"event-type"},isServer:{context:"isServer"},result:{state:!0},showWhitResult:{type:Boolean,attr:"show-whit-result"}}}static get events(){return[{name:"eventCompleted",method:"eventCompleted",bubbles:!0,cancelable:!0,composed:!0}]}static get style(){return""}}export{t as NewtonEventFeed};