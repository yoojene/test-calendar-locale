/*! Built with http://stenciljs.com */
const{h:e}=window.NewtonComponents;import{a as t,b as s}from"./chunk-0fe62cc8.js";const a=t||s;class o{constructor(){this.showDegreeSymbol=!0,this.showDegreeSystem=!1,this.system="F",this.icons=[{name:"default",path:"/assets/images/weather/AfternoonDashboard.png"}],this.debug=!1}setIcon(e,t){const s=this.icons.findIndex(t=>t.name===e);-1===s?this.icons.push({name:e,path:t}):this.icons[s]={name:e,path:t}}systemWatch(){this.parseTemperature()}wsSet(e,t){this.ws=e,e!==t&&this.loadWeather()}rerender(){this.componentDidLoad()}loadWeather(){this.convertLocationToLatLon(),(this.lat||this.lon)&&this.ws.get({lat:this.lat,long:this.lon,timestamp:Math.floor((new Date).getTime()/1e3).toString()}).then(e=>e.currently).then(e=>{this.onWeatherDataAcquired.emit(e),this.apiTemp=parseFloat(e.temperature),this.description=e.summary,this.parseTemperature(),this.changeBackgroundBasedOnWeather(e.icon)}).catch(e=>this.onWeatherDataFailed.emit(e))}componentDidLoad(){this.changeBackgroundBasedOnWeather("default")}parseTemperature(){const e="C"!==this.system?this.apiTemp:(this.apiTemp-32)/1.8;this.temperature=Math.round(e).toString()}convertLocationToLatLon(){this.location&&([this.lat,this.lon]=this.location.split(","))}componentWillLoad(){if(this.weatherService)this.ws=this.weatherService;else{if("undefined"==typeof newtonService)return void(this.debug&&console.error("Newton Service not installed, please install @pfizer/newton-js-sdk and bind it to the window."));this.ws=newtonService.service("weather")}this.ws&&this.location&&this.loadWeather()}changeBackgroundBasedOnWeather(e){let t,s=this.icons.filter(t=>t.name===e);if(s.length||(s=this.icons.filter(e=>"default"===e.name)),!(t=s.length?s[0]:null))return;const o=a(),r=s.filter(e=>!(e.timeBefore&&!o.isBefore(a(e.timeBefore,"HH:mm"))||e.timeAfter&&!o.isAfter(a(e.timeAfter,"HH:mm"))));t=r.length?r[0]:t,this.el.querySelector(".weather-card").style.backgroundImage=`url(${t.path})`}getGeolocation(e){this.onAccessLocation.emit(e)}render(){return e("div",{class:"container"},e("div",{class:"weather-card",onClick:e=>this.getGeolocation(e)},e("slot",{name:"weather-contents"},e("div",{class:"weather-card-contents"},this.temperature?e("div",{class:"weather-text-container"},e("div",{class:"weather-temp"},this.temperature,this.showDegreeSymbol&&this.temperature?"°":"",this.showDegreeSystem?`${this.system}`:""),e("div",{class:"weather-desc"},this.description)):e("slot",{name:"no-weather"},e("div",{class:"weather-text-container"},e("div",{class:"weather-temp"},"--",this.showDegreeSymbol&&this.temperature?"°":"",this.showDegreeSystem?`${this.system}`:""),e("div",{class:"weather-desc"},"N/A"))))),e("slot",{name:"weather-permissions"},e("div",{class:"weather-permissions"},"Enable Location"))))}static get is(){return"newton-weather-card"}static get properties(){return{changeBackgroundBasedOnWeather:{method:!0},debug:{type:Boolean,attr:"debug"},description:{state:!0},el:{elementRef:!0},icons:{type:"Any",attr:"icons",reflectToAttr:!0},lat:{state:!0},loadWeather:{method:!0},location:{type:String,attr:"location",watchCallbacks:["loadWeather"]},lon:{state:!0},rerender:{method:!0},setIcon:{method:!0},showDegreeSymbol:{type:Boolean,attr:"show-degree-symbol"},showDegreeSystem:{type:Boolean,attr:"show-degree-system"},system:{type:String,attr:"system",watchCallbacks:["systemWatch"]},temperature:{state:!0},weatherService:{type:"Any",attr:"weather-service",watchCallbacks:["wsSet"]}}}static get events(){return[{name:"onAccessLocation",method:"onAccessLocation",bubbles:!0,cancelable:!0,composed:!0},{name:"onWeatherDataAcquired",method:"onWeatherDataAcquired",bubbles:!0,cancelable:!0,composed:!0},{name:"onWeatherDataFailed",method:"onWeatherDataFailed",bubbles:!0,cancelable:!0,composed:!0}]}static get style(){return"newton-weather-card{--tempFontSize:3rem;--descFontSize:2rem;--weatherPermsBottomOffset:-40px}newton-weather-card .weather-card{background-color:#58bfc4;background-size:cover;color:#fff;text-align:center;background-repeat:no-repeat;background-position:center;height:180px}newton-weather-card .weather-text-container{padding-top:15%;width:100%;text-align:center;color:var(--black)}newton-weather-card .weather-temp{font-size:var(--tempFontSize);line-height:var(--tempFontSize);font-weight:700}newton-weather-card .weather-desc{font-size:var(--descFontSize);font-weight:700}newton-weather-card .weather-permissions{position:relative;bottom:var(--weatherPermsBottomOffset)}"}}export{o as NewtonWeatherCard};